{{extend 'layout.html'}}

<div class="container">
{{if form.errors:}}
    <div class="alert alert-warning">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <strong>Your submitted form contains the following errors</strong>
        <ul>
        {{for fieldname in form.errors:}}
            <li>{{=fieldname}} error: {{=form.errors[fieldname]}}</li>
        {{pass}}
        </ul>
    </div>
{{form.errors.clear()}}
{{pass}}

{{=form.custom.begin}}
    <div class="row">
        <div class="col-xs-10">
            <h3>Editing Collection <strong>{{=collection.name}}</strong></h3>
        </div>
        <div class="col-xs-2">
        {{if not is_unfiled:}}
            <button type="submit" name="delete_this_record" value="yes" class="btn btn-danger btn-block"
                    onclick="return confirm('Are you sure you want to delete this collection? \n You won\'t lose your items, they\'ll be moved to your Unfiled collection.')">Delete
            </button>
        {{pass}}
        </div>
    </div>

    <p class="text-info">
        Fields marked with an asterisk (*) are mandatory.
    </p>

    <div class="form-group">
        <label for="collections_name" class="mandatory">{{=form.custom.label.name}}</label>
    {{=form.custom.widget.name}}
    </div>

    <div class="form-group">
        <label for="collections_private" data-toggle="tooltip" data-placement="right"
               title="{{=form.custom.label.private}}">
        {{=form.custom.widget.private}}
            Private
        </label>
    </div>

    <h3>Items in Collection</h3>

    <div class="panel panel-default">
        <div class="panel-body">
        {{print_sortby()}}
        {{for chunk in chunks(objects_in_collection, 3):}}
            <div class="row">
            {{for object in chunk:}}
                <div class="col-xs-4" id="object-{{=object.id}}">
                    <div class="clearfix">
                        <a href="#remove" class="remove pull-right" data-id="{{=object.id}}">
                            <span class="glyphicon glyphicon-remove middle"></span>
                        </a>
                    </div>
                {{print_object(object, False)}}
                </div>
            {{pass}}
            </div>
        {{pass}}
        </div>
    </div>

    <div class="form-group clearfix">
        <a href="{{=URL('collections', 'show', args=collection.id)}}" class="btn btn-default pull-left">Cancel</a>
        <button type="submit" name="submit" value="save" class="btn btn-success pull-right">Save Collection</button>
    </div>

{{=form.custom.end}}
</div>

<div class="undo">
    <div class="container">
        <div class="row">
            <div class="col-xs-10">
                To undo removing an item, press undo.
            </div>
            <div class="col-xs-2">
                <a class="btn btn-warning">Undo</a>
            </div>
        </div>
    </div>
</div>

<script src="{{=URL('static','js/collection.js')}}"></script>